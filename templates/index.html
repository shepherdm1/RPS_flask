<html>
<head>
<meta charset="utf-8">
<title>Display Webcam Stream</title>

<style>
#container {
	margin: 0px auto;
	width: 600px;
	height: 400px;
	border: 10px #333 solid;
}
#videoElement {
	width: 600px;
	height: 400px;
	background-color: #666;
}
</style>
</head>

<body>
<div id="container">
	<video autoplay="true" id="videoElement"></video>
</div>

<input type="button" value="Capture" onclick="capture()"/>
<canvas id="c" width="300" height="200"></canvas>

<p>Result: <b><span id="message"></span></b></p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
	var video = document.querySelector("#videoElement");
	if (navigator.mediaDevices.getUserMedia) {
		navigator.mediaDevices.getUserMedia({ video: { width: 300, height: 200 }})
			.then(function (stream) {
				video.srcObject = stream;
			})
			.catch(function (err0r) {
				console.log("Something went wrong!");
			});
	}
    else {
        document.getElementById('message').innerHTML = "you need a webcam to play"
    }
	function capture() {
		var canvas = document.getElementById('c');
        canvas.width = video.videoWidth;
		canvas.height = video.videoHeight;
		canvas.getContext('2d').drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
        var dataURL = canvas.toDataURL().split(';base64,')[1];

		$.ajax({
           type: "POST",
            url: "/get_image",
            data:{imageBase64: dataURL},
            success: function (res) { document.getElementById('message').innerHTML = res },
            error: function (error) { console.log(error) }
        })
	}
</script>
</body>
</html>